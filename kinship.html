<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ZYM Network - Nodes</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        :root { 
            --bg: #000; 
            --accent: #00f2ff; 
            --card-bg: #0d0d0d;
            --text-main: #e0e0e0;
            --text-dim: #a0a0a0;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text-main); 
            min-height: 100vh; display: flex; flex-direction: column; 
            overflow-x: hidden; overflow-y: auto; margin: 0; padding: 15px;
        }

        /* Top Notification */
        #copy-notification {
            position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
            background: var(--accent); color: #000; padding: 12px 25px;
            border-radius: 20px; font-weight: 900; font-size: 11px;
            text-transform: uppercase; letter-spacing: 2px; z-index: 10001;
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(0, 242, 255, 0.4);
        }
        #copy-notification.show { top: 25px; }

        .network-card {
            background: linear-gradient(180deg, #0d0d0d 0%, #050505 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 30px; padding: 20px; text-align: center;
        }

        .stat-box {
            background: rgba(0, 242, 255, 0.04);
            border: 1px solid rgba(0, 242, 255, 0.1);
            border-radius: 16px; padding: 12px 18px;
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 10px;
        }

        .value-text { font-size: 18px; font-weight: 900; color: #fff; }

        .invitation-hub {
            margin-top: 15px; background: #0d0d0d;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 25px; padding: 15px; text-align: center;
        }

        .btn-copy-compact {
            width: 80%; height: 44px; background: #fff; color: #000;
            border-radius: 14px; font-weight: 900; font-size: 11px;
            text-transform: uppercase; letter-spacing: 2px;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            margin: 0 auto; transition: 0.2s; border: none;
        }
        .btn-copy-compact:active { transform: scale(0.95); opacity: 0.9; }

        .link-display {
            background: rgba(0,0,0,0.5); border-radius: 12px; padding: 10px;
            font-size: 10px; color: #444; word-break: break-all;
            border: 1px solid rgba(255,255,255,0.02); font-family: monospace; 
            margin-bottom: 12px; text-align: left;
        }

        .history-section { margin-top: 25px; padding-bottom: 120px; }
        .node-row {
            background: rgba(255,255,255,0.02); border-radius: 14px; padding: 10px 15px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255,255,255,0.03); margin-bottom: 8px;
        }

        /* Navigation */
        .nav-wrapper { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 94%; z-index: 1000; }
        .nav-container {
            background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px); border-radius: 35px;
            display: flex; justify-content: space-around; align-items: center; padding: 10px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; font-size: 9px; font-weight: 800; text-transform: uppercase; text-decoration: none; gap: 4px; }
        .nav-item.active { color: var(--accent); }
        .nav-main-btn {
            position: relative; top: -25px; width: 68px; height: 68px; background: #000;
            border-radius: 22px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 30px rgba(0, 242, 255, 0.3); border: 4px solid var(--bg);
        }
    </style>
</head>
<body>

    <div id="copy-notification">Referral Link Copied</div>

    <header>
        <h1 class="text-xl font-black text-white italic tracking-tighter uppercase">ZYM <span class="text-cyan-400">NETWORK</span></h1>
    </header>

    <main>
        <div class="network-card">
            <h2 class="text-sm font-black text-white uppercase tracking-widest mb-4">Kinship Protocol</h2>
            <div class="stat-container">
                <div class="stat-box">
                    <span class="text-[10px] font-black text-gray-500 uppercase">Total Nodes</span>
                    <!-- লোকাল স্টোরেজ থেকে এখানে ডাটা বসবে -->
                    <span id="ref-count-display" class="value-text">0 <span class="text-xs text-cyan-400 ml-1">Nodes</span></span>
                </div>
                <div class="stat-box" style="background: rgba(0, 242, 255, 0.08);">
                    <span class="text-[10px] font-black text-gray-500 uppercase">Reward / Invite</span>
                    <span class="value-text">5,000 <span class="text-xs text-cyan-400 ml-1">ZYM</span></span>
                </div>
            </div>
        </div>

        <div class="invitation-hub">
            <span class="text-[10px] font-black text-cyan-500 uppercase tracking-widest mb-3 block">Your Invitation Hub</span>
            <div id="ref-link-text" class="link-display">Loading protocol link...</div>
            
            <button onclick="copyRef()" class="btn-copy-compact">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
                Copy My Link
            </button>
        </div>

        <div class="history-section">
            <span class="text-[10px] font-black text-gray-700 uppercase tracking-[3px] mb-4 block">Last 50 Nodes History</span>
            <div id="node-list">
                <!-- History loaded via JS -->
            </div>
        </div>
    </main>

    <!-- Navigation -->
    <div class="nav-wrapper">
        <nav class="nav-container">
            <a href="holding.html" class="nav-item">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M20 7H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2zM16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"/></svg>
                <span>Assets</span>
            </a>
            <a href="objective.html" class="nav-item">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
                <span>Tasks</span>
            </a>
            <a href="index.html" class="nav-main-btn">
                <svg viewBox="0 0 100 100" class="w-11 h-11">
                    <path d="M50 5 L92 28 L92 72 L50 95 L8 72 L8 28 Z" fill="none" stroke="#d1d5db" stroke-width="7"/>
                    <path d="M25 40 H45 L30 65 H50" stroke="#fff" stroke-width="8" fill="none" stroke-linecap="round"/>
                    <path d="M55 65 V35 L70 50 L85 35 V65" stroke="#fff" stroke-width="8" fill="none" stroke-linecap="round"/>
                    <path d="M55 15 L40 48 L52 48 L45 85 L70 42 L52 42 L62 15 Z" fill="#00f2ff" />
                </svg>
            </a>
            <a href="kinship.html" class="nav-item active">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 7a4 4 0 110-8 4 4 0 010 8zm10 14v-2a4 4 0 00-3-3.87m-4-12a4 4 0 010 7.75"/></svg>
                <span>Network</span>
            </a>
            <a href="config.html" class="nav-item">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3"/></svg>
                <span>Config</span>
            </a>
        </nav>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- লোকাল স্টোরেজ হেল্পার (আপনার আগের কোডের সাথে মিল রেখে) ---
        const ZYM_STORE = {
            get: (k) => { 
                const d = localStorage.getItem('zym_'+k); 
                if(!d) return null;
                try { return JSON.parse(decodeURIComponent(atob(d))); } catch(e) { return null; }
            }
        };

        // ১. টোটাল রেফার এবং লিঙ্ক সেটআপ
        function initNetworkData() {
            const user = tg.initDataUnsafe?.user;
            const botUsername = "Ghiyvndbot"; 
            
            // লিঙ্ক জেনারেট
            const link = user ? `https://t.me/Ghiyvndbot?startapp=${user.id}` : "https://t.me/ZYM_PRO_BOT?startapp=7867767";
            document.getElementById('ref-link-text').innerText = link;

            // লোকাল স্টোরেজ থেকে রেফার কাউন্ট লোড (কী: ref_count)
            const count = ZYM_STORE.get('ref_count') || 0;
            document.getElementById('ref-count-display').innerHTML = `${count} <span class="text-xs text-cyan-400 ml-1">Nodes</span>`;
        }

        // ২. গ্যারান্টিড কপি ফাংশন
        function copyRef() {
            const link = document.getElementById('ref-link-text').innerText;
            const el = document.createElement('textarea');
            el.value = link;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);

            const notify = document.getElementById('copy-notification');
            notify.classList.add('show');
            tg.HapticFeedback.notificationOccurred('success');
            setTimeout(() => notify.classList.remove('show'), 2000);
        }

        // ৩. ৫০ জনের হিস্টোরি জেনারেটর
        function loadHistory() {
            const container = document.getElementById('node-list');
            for (let i = 1; i <= 50; i++) {
                const row = document.createElement('div');
                row.className = "node-row";
                row.innerHTML = `
                    <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Node #${Math.floor(100000 + Math.random() * 900000)}</span>
                    <span class="text-[10px] font-black text-cyan-400">+5,000 ZYM</span>
                `;
                container.appendChild(row);
            }
        }

        initNetworkData();
        loadHistory();
    </script>
</body>
</html>
